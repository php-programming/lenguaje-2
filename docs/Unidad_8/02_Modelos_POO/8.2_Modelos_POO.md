# 8.2 Modelos en POO: Arquitectura de Datos

El objetivo es dejar de escribir SQL disperso y crear una capa de acceso a datos robusta.

## 1. El Guardián de la Conexión (Singleton)

Creamos una clase `Database` que encapsula la conexión (PDO). Usamos el patrón **Singleton** para asegurar que solo exista una conexión abierta, ahorrando recursos.

```php
class Database {
    private static $instance = null;
    private $conn;

    private function __construct() {
        $this->conn = new PDO(...);
    }

    public static function getInstance() {
        if (!self::$instance) {
            self::$instance = new Database();
        }
        return self::$instance;
    }
}
```

## 2. Modelos Específicos (Entidades)

Clases simples que representan una fila de la base de datos. Son contenedores de datos.

```php
class Usuario {
    public $id;
    public $nombre;
    public $email;
}
```

## 3. Repositorios (Data Access Object - DAO)

Clases encargadas de la lógica de persistencia (SQL). Separan la lógica de negocio del acceso a datos.

*   `UsuarioRepository`: Tiene métodos como `find($id)`, `save($user)`, `delete($id)`.
*   Usa la clase `Database` para ejecutar las consultas y devuelve objetos `Usuario`.

Esta arquitectura permite cambiar la base de datos sin tocar los controladores ni las vistas.
