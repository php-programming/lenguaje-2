# 2.1 El Problema: Anomalías y Dependencias Funcionales

## Caso de Uso

**Escenario:** Para el SISA, un diseñador junior propone una única tabla "plana" para registrar las inscripciones. La intención es tener toda la información en un solo lugar.

**Tabla `Inscripciones_No_Normalizada`:**

| ID_Inscripcion (PK) | ID_Estudiante | Nombre_Estudiante | Email_Estudiante | ID_Curso | Nombre_Curso | Creditos_Curso | ID_Profesor | Nombre_Profesor | Email_Profesor |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | 101 | Ana Torres | ana@sisa.edu | CS101 | Intro a la IA | 4 | P20 | Dr. Alan Turing | turing@sisa.edu |
| 2 | 102 | Luis Rios | luis@sisa.edu | CS101 | Intro a la IA | 4 | P20 | Dr. Alan Turing | turing@sisa.edu |
| 3 | 101 | Ana Torres | ana@sisa.edu | MA203 | Cálculo Vectorial | 3 | P30 | Dr. Isaac Newton | newton@sisa.edu |

A primera vista, parece conveniente. Sin embargo, este diseño sufre de graves problemas estructurales conocidos como **anomalías de datos**.

---

## 1. Anomalías de Datos

Una anomalía es un efecto secundario indeseable que ocurre al insertar, actualizar o eliminar datos en una tabla mal diseñada.

### a. Anomalía de Inserción
**Problema:** ¿Cómo podemos añadir un nuevo curso que aún no tiene estudiantes inscritos?
**Respuesta:** No podemos. Para que un curso exista, debemos insertar una fila completa, lo que requiere un `ID_Estudiante`. No podemos registrar el curso "CS301 - Sistemas Operativos" hasta que al menos un estudiante se inscriba. La estructura de la tabla nos impide registrar una entidad (`Curso`) de forma independiente.

### b. Anomalía de Actualización
**Problema:** El `Email_Profesor` del Dr. Turing cambia a `alan.turing@sisa.edu`.
**Respuesta:** Debemos buscar y actualizar **TODAS las filas** donde aparezca el Dr. Turing. Si olvidamos actualizar una sola fila (la inscripción de Luis Rios), la base de datos se vuelve inconsistente. Tendríamos dos emails diferentes para el mismo profesor, y no sabríamos cuál es el correcto. Esta redundancia multiplica el riesgo de errores.

### c. Anomalía de Borrado
**Problema:** Ana Torres (`ID_Estudiante` 101) se da de baja de su único curso restante, "Cálculo Vectorial" (`ID_Inscripcion` 3).
**Respuesta:** Al eliminar la fila 3, no solo eliminamos la inscripción, sino que **perdemos toda la información sobre el curso "Cálculo Vectorial"** (su nombre, créditos, etc.) si Ana era la única inscrita. La eliminación de un dato provoca la pérdida no intencionada de otro.

## 2. Dependencias Funcionales (DF)

Para solucionar estas anomalías de forma sistemática, necesitamos una herramienta formal: la **Dependencia Funcional**.

**Definición:** Un atributo B tiene una dependencia funcional de un atributo A (escrito como **A → B**) si, para cada valor de A en la tabla, existe **exactamente un** valor de B asociado.

En otras palabras: **"Conociendo el valor de A, puedo determinar inequívocamente el valor de B."**

### Identificando las DF en nuestra tabla:

*   `ID_Estudiante → Nombre_Estudiante` (Con el ID del estudiante, sé su nombre)
*   `ID_Estudiante → Email_Estudiante`
*   `ID_Curso → Nombre_Curso` (Con el ID del curso, sé su nombre)
*   `ID_Curso → Creditos_Curso`
*   `ID_Profesor → Nombre_Profesor`
*   `ID_Profesor → Email_Profesor`

**El problema central de nuestro diseño es que la clave primaria (`ID_Inscripcion`) no es el determinante de la mayoría de los atributos.** Por ejemplo, `Nombre_Curso` no depende de `ID_Inscripcion`, depende de `ID_Curso`. Esta es la causa raíz de las anomalías.

**Conclusión:** Las anomalías de datos son un síntoma de un diseño deficiente. Las dependencias funcionales son la herramienta de diagnóstico que nos permite identificar las causas subyacentes. El proceso de normalización, que veremos a continuación, es el tratamiento que consiste en **descomponer las tablas para que los atributos dependan únicamente de la clave primaria apropiada**, eliminando así las anomalías.
