# 16.1 Generación de Reportes PDF con FPDF

## Caso de Uso

**Escenario:** El sistema administrativo requiere generar una factura oficial o un listado de alumnos inscritos para imprimir.
**Problema:** HTML no es un formato fiable para impresión (los navegadores cambian los márgenes, colores, etc.).
**Solución:** Generar un archivo PDF (Portable Document Format) desde el servidor.

---

## Uso de la Librería FPDF

FPDF es una clase PHP que permite generar archivos PDF con código puro, sin necesidad de librerías externas (como PDFlib).

### Instalación

Aunque se puede descargar el archivo `.php`, lo profesional es usar Composer:
`composer require setasign/fpdf`

### Implementación en un Controlador

```php
// controllers/ReporteController.php
use FPDF;

class ReporteController {
    public function generarListadoAlumnos() {
        $repo = new AlumnoRepository();
        $alumnos = $repo->obtenerTodos();

        // 1. Crear instancia PDF
        $pdf = new FPDF();
        $pdf->AddPage();
        $pdf->SetFont('Arial', 'B', 16);

        // 2. Cabecera
        $pdf->Cell(40, 10, 'Listado de Alumnos');
        $pdf->Ln(20); // Salto de línea

        // 3. Cuerpo (Tabla)
        $pdf->SetFont('Arial', '', 12);
        foreach ($alumnos as $alumno) {
            $pdf->Cell(10, 10, $alumno->id, 1);
            $pdf->Cell(80, 10, utf8_decode($alumno->nombre), 1);
            $pdf->Cell(80, 10, $alumno->email, 1);
            $pdf->Ln();
        }

        // 4. Salida (D = Descargar, I = Ver en navegador)
        $pdf->Output('I', 'reporte_alumnos.pdf');
    }
}
```

**Nota de Ingeniería:** La generación de PDFs consume mucha memoria. Para reportes masivos (miles de páginas), se deben usar técnicas de streaming o procesos en segundo plano (Background Jobs).
