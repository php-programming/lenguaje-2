# 9.3 Controlador de Operaciones Genéricas

El término **Controlador de Operaciones Genéricas** se refiere en este contexto a una Clase Base del Modelo (un `ModeloPadre` o `ModeloBase`) que centraliza la lógica de interacción básica con la DB, permitiendo que todos los modelos específicos (como `ProductoModel` o `UsuarioModel`) hereden y reutilicen ese código.

## Concepto Teórico: Herencia y Reutilización de Código

En POO, la **Herencia** nos permite definir una clase con características y comportamientos comunes (la Clase Padre) y luego crear clases que la extiendan (las Clases Hijas).

- **Problema sin Clase Genérica**: Si tenemos 10 modelos, tendríamos que escribir el código de `obtenerTodos()` y `guardar()` 10 veces, una por cada modelo.
- **Solución con Clase Genérica**: Creamos una clase `ModeloBase` que contiene `obtenerTodos()` y `guardar()`. Los 10 modelos solo tienen que extender `ModeloBase` para obtener automáticamente esas funcionalidades.

## Diseño de la Clase Base: `ModeloBase.php`

Esta clase actuará como nuestro Controlador de Operaciones Genéricas.

```php
<?php
/**
 * Clase ModeloBase: Centraliza las operaciones CRUD genéricas.
 * Usa propiedades protegidas para ser accesible solo por las clases hijas (encapsulamiento).
 */
class ModeloBase {

    // Propiedad que guarda la "tabla" con la que trabaja el modelo.
    // Esta debe ser redefinida por cada clase hija (ej: 'productos', 'usuarios').
    protected $tabla = null;

    // Simulación de la "Conexión" o "Gestor de DB"
    protected $db_conn;

    public function __construct($tabla = null) {
        // En una app real, aquí se inicializaría la conexión a la base de datos.
        $this->db_conn = "Conexión a MySQL establecida"; 
        
        if ($tabla !== null) {
            $this->tabla = $tabla;
        }
        
        echo "Modelo Base inicializado para la tabla: **" . $this->tabla . "** <br>";
    }

    // Método Genérico: Obtener todos los registros de la tabla
    public function obtenerTodos() {
        if ($this->tabla === null) {
            return "Error: Tabla no definida.";
        }
        // Simulación de consulta SQL: SELECT * FROM tabla
        return [
            ['id' => 1, 'info' => 'Dato genérico de ' . $this->tabla],
            ['id' => 2, 'info' => 'Otro dato de ' . $this->tabla]
        ];
    }

    // Método Genérico: Guardar un registro (simula INSERT o UPDATE)
    public function guardar(array $datos) {
        if ($this->tabla === null) {
            return "Error: Tabla no definida.";
        }
        // Simulación de SQL: INSERT INTO tabla (...) VALUES (...)
        return "Guardado en la tabla **" . $this->tabla . "** los datos: " . json_encode($datos);
    }
}
?>
```
